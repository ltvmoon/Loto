<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loto Vi·ªát Nam Online</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div id="app">
    <div id="login-screen">
        <h1 style="color: #2c3e50; font-size: 2.5em; margin-bottom: 20px;">ƒêƒÇNG NH·∫¨P</h1>
        <div style="background: white; padding: 30px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 100%; max-width: 400px; display: flex; flex-direction: column; align-items: center;">
            <label for="username"></label><input type="text" id="username" placeholder="T√™n ƒëƒÉng nh·∫≠p" style="width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 6px;">
            <label for="password"></label><input type="password" id="password" placeholder="M·∫≠t kh·∫©u" style="width: 100%; padding: 12px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 6px;">
            <button class="btn btn-primary" onclick="login()" style="width: 100%;">ƒêƒÇNG NH·∫¨P</button>
            <p style="margin-top: 15px; color: #7f8c8d; font-size: 0.9em;">H·ªá th·ªëng n·ªôi b·ªô. Li√™n h·ªá Admin ƒë·ªÉ c·∫•p t√†i kho·∫£n.</p>
        </div>
    </div>

    <div id="admin-dashboard" class="hidden container-center">
        <h1>QU·∫¢N TR·ªä VI√äN</h1>
        <h3 id="welcome-admin" style="color: #34495e;">Xin ch√†o, Admin</h3>
        <div style="display: flex; gap: 20px; margin-top: 30px;">
            <div class="card-option" onclick="navToLobby()">
                <h2 style="font-size: 3em; margin: 0;">üéÆ</h2>
                <h3>V√†o Ph√≤ng Ch∆°i</h3>
                <p>T·∫°o ph√≤ng ho·∫∑c tham gia game</p>
            </div>
            <div class="card-option" onclick="navToUserManager()">
                <h2 style="font-size: 3em; margin: 0;">üë•</h2>
                <h3>Qu·∫£n L√Ω User</h3>
                <p>T·∫°o t√†i kho·∫£n, xem s·ªë d∆∞</p>
            </div>
        </div>
        <button class="btn btn-stop" style="margin-top: 30px;" onclick="logout()">ƒêƒÉng Xu·∫•t</button>
    </div>

    <div id="admin-user-manager" class="hidden container-center" style="justify-content: start; padding-top: 50px;">
        <div style="width: 100%; max-width: 800px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <button class="btn btn-reset" onclick="navToAdminDashboard()">‚¨Ö Quay l·∫°i Dashboard</button>
                <h2 style="margin: 0; color: #2c3e50;">QU·∫¢N L√ù T√ÄI KHO·∫¢N</h2>
            </div>

            <div class="panel" style="margin-bottom: 20px; background: #e3f2fd; border: 1px solid #90caf9;">
                <h3 style="margin-top: 0;">Th√™m User M·ªõi</h3>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <label for="new-username"></label><input type="text" id="new-username" placeholder="Username" style="padding: 10px; flex: 1; border-radius: 4px; border: 1px solid #ccc;">
                    <label for="new-password"></label><input type="text" id="new-password" placeholder="Password" style="padding: 10px; flex: 1; border-radius: 4px; border: 1px solid #ccc;">

                    <label for="new-initial-balance"></label><input type="number" id="new-initial-balance" placeholder="S·ªë d∆∞ ban ƒë·∫ßu (VD: 0)" style="padding: 10px; flex: 1; border-radius: 4px; border: 1px solid #ccc;">

                    <label for="new-role"></label><select id="new-role" style="padding: 10px; border-radius: 4px; border: 1px solid #ccc;">
                        <option value="user">User</option>
                        <option value="admin">Admin</option>
                    </select>
                    <button class="btn btn-success" onclick="createNewUser()">T·∫°o Ngay</button>
                </div>
            </div>

            <div class="panel">
                <h3>Danh S√°ch User</h3>
                <div style="max-height: 400px; overflow-y: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                        <tr style="background: #eee; text-align: left;">
                            <th style="padding: 10px; position: sticky; top: 0; background: #eee;">User</th>
                            <th style="padding: 10px; position: sticky; top: 0; background: #eee;">Role</th>
                            <th style="padding: 10px; position: sticky; top: 0; background: #eee;">S·ªë d∆∞</th>
                            <th style="padding: 10px; position: sticky; top: 0; background: #eee; text-align: center;">Thao t√°c</th>
                        </tr>
                        </thead>
                        <tbody id="user-list-body">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="edit-user-modal" class="hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000;">
        <div style="background: white; padding: 20px; border-radius: 8px; width: 300px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
            <h3 style="margin-top: 0;">S·ª≠a User: <span id="edit-target-username" style="color: #3498db;"></span></h3>

            <label style="font-weight: bold; font-size: 0.9em;">M·∫≠t kh·∫©u m·ªõi (ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng ƒë·ªïi):</label>
            <label for="edit-new-password"></label><input type="text" id="edit-new-password" placeholder="Nh·∫≠p pass m·ªõi..." style="width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px;">

            <label style="font-weight: bold; font-size: 0.9em;">S·ªë d∆∞ m·ªõi:</label>
            <label for="edit-new-balance"></label><input type="number" id="edit-new-balance" placeholder="Nh·∫≠p s·ªë ti·ªÅn..." style="width: 100%; padding: 8px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 4px;">

            <div style="display: flex; justify-content: flex-end; gap: 10px;">
                <button class="btn btn-reset" onclick="closeEditModal()">H·ªßy</button>
                <button class="btn btn-success" onclick="submitEditUser()">L∆∞u L·∫°i</button>
            </div>
        </div>
    </div>

    <div id="lobby-screen" class="hidden container-center">
        <div style="width: 100%; max-width: 600px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0; color: #2c3e50;">S·∫¢NH CH·ªú</h2>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-weight: bold;">üë§ <span id="lobby-username">...</span></span>
                    <button class="btn btn-reset" onclick="handleLobbyBack()" style="padding: 5px 10px; font-size: 0.9em;">Tho√°t</button>
                </div>
            </div>

            <div class="panel">
                <h3>Danh s√°ch ph√≤ng</h3>
                <div class="room-list-container" id="room-list">
                    <div style="text-align:center; padding: 20px; color: #7f8c8d;">ƒêang t·∫£i danh s√°ch...</div>
                </div>
                <div style="margin-top: 15px;">
                    <button class="btn btn-create-room" onclick="createRandomRoom()">‚ûï T·∫†O PH√íNG M·ªöI</button>
                </div>
            </div>
        </div>
    </div>

    <div id="game-grid" class="hidden">
        <div class="col-left">
            <div class="panel user-info-card">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                    <button onclick="leaveRoom()" class="btn btn-reset" style="padding: 5px 10px; font-size: 0.8em;">‚¨Ö R·ªùi ph√≤ng</button>
                    <span style="font-weight: bold; color: #7f8c8d;">Ph√≤ng: <span id="display-room-id">...</span></span>
                </div>

                <div class="avatar-circle" id="avatar-char">U</div>
                <div id="display-name" style="font-weight: bold; font-size: 1.2em; margin: 10px 0;">...</div>
                <span class="balance-display" id="display-balance">0</span>

                <div class="game-info-stats">
                    <div class="stat-item"><span>GI√Å V√â</span><strong id="current-price-display">0</strong></div>
                    <div class="stat-item"><span>H≈®</span><strong id="current-pot-display" style="color:#c0392b;">0</strong></div>
                </div>
            </div>
            <div class="panel">
                <h3>Nh·∫≠t K√Ω</h3>
                <div id="log-area"></div>
            </div>
            <div class="panel">
                <h3>Ng∆∞·ªùi Ch∆°i (<span id="user-count">0</span>)</h3>
                <div id="participants-list"></div>
            </div>
        </div>

        <div class="col-center">
            <div id="host-panel" class="panel hidden">
                <h3 style="color: white; border-bottom-color: rgba(255,255,255,0.3);">üëë Host Control</h3>
                <div class="host-controls" style="border-bottom: 1px dashed rgba(255,255,255,0.2); padding-bottom: 10px;">
                    <label for="host-price-input">üí≤ Gi√°:</label> <input type="number" id="host-price-input" class="input-price" value="0" step="1000"> <button class="btn btn-price" onclick="setPrice()">ƒê·∫∂T</button>
                </div>
                <div class="host-controls" style="border-bottom: 1px dashed rgba(255,255,255,0.2); padding-bottom: 10px;">
                    <label>‚è© Chuy·ªÉn Host:</label>
                    <label for="transfer-target"></label><select id="transfer-target" class="input-transfer" style="width: 120px; padding: 5px;"><option value="">-- Ch·ªçn --</option></select>
                    <button class="btn btn-reset" style="padding: 5px;" onclick="transferHost()">OK</button>
                </div>
                <div class="host-controls">
                    <div id="draw-controls-wrapper">
                        <label for="auto-interval">‚è±Ô∏è Gi√¢y:</label> <input type="number" id="auto-interval" class="input-secs" value="3" min="1" max="10">
                        <button id="btn-auto-draw" class="btn btn-draw" onclick="toggleAutoDraw()">‚ñ∂ QUAY</button>
                    </div>
                    <button id="btn-reset-game" class="btn btn-reset" onclick="if(confirm('Reset v√°n?')) hostAction('RESET')">V√ÅN M·ªöI üîÑ</button>
                </div>
            </div>
            <div id="my-tickets-dashboard" class="panel">
                <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #f0f2f5; padding-bottom: 10px; margin-bottom: 10px;">
                    <h3 style="border:none; margin:0; padding:0;">üé´ V√© C·ªßa B·∫°n (<span id="ticket-count">0</span>/2)</h3>

                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span id="mode-label" style="font-size: 0.9em; font-weight: bold; color: #7f8c8d;">Manual (T·ª± ch·ªçn)</span>
                        <label class="switch" style="position: relative; display: inline-block; width: 50px; height: 24px;">
                            <input type="checkbox" id="auto-mode-toggle" onclick="toggleAutoMode(this)">
                            <span class="slider round" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px;"></span>
                            <style>
                                .switch input { opacity: 0; width: 0; height: 0; }
                                .slider.round:before { position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
                                input:checked + .slider { background-color: #2196F3; }
                                input:checked + .slider:before { transform: translateX(26px); }
                            </style>
                        </label>
                    </div>
                </div>

                <div id="my-tickets-container" class="my-ticket-wrapper"></div>
                <div id="confirm-section" class="hidden" style="margin-top: 15px;"><button class="btn btn-success" onclick="confirmSelection()">‚úÖ X√ÅC NH·∫¨N CH·ªêT V√â</button></div>
            </div>
            <div id="pool-area" class="panel"><h3>Ch·ªçn V√©</h3><div id="pool-grid"></div></div>
            <button class="btn btn-wait hidden" id="btn-wait" onclick="signalWait()">‚úã B√ÅO CH·ªú</button>
        </div>

        <div class="col-right">
            <div class="panel" id="current-ball-wrapper"><h4>S·ªê V·ª™A K√äU</h4><span id="current-ball">--</span><div id="recent-history-list">...</div></div>
            <div class="panel"><h3>Ti·∫øn Tr√¨nh</h3><div style="display:flex;justify-content:space-between;margin-bottom:10px;"><span>ƒê√£ g·ªçi: <span id="stat-drawn">0</span></span><span>C√≤n: <span id="stat-remain">90</span></span></div><div id="master-grid"></div></div>
            <div class="panel"><h3>üì¢ Th√¥ng B√°o</h3><div id="wait-leaderboard"><div style="color:#aaa;text-align:center;">Tr·ªëng</div></div><hr><div id="win-status-area"></div></div>
        </div>
    </div>
</div>

<script type="module" src="js/main.js"></script>
</body>
</html>